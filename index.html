<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WB Power Services - Equipment Failure Prediction Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif; background: #111827; color: #fff; min-height: 100vh; }
        .header { background: #1f2937; border-bottom: 1px solid #374151; padding: 16px 24px; }
        .header-top { display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 16px; }
        .header-left { display: flex; align-items: center; gap: 12px; }
        .header-icon { background: #2563eb; padding: 10px; border-radius: 8px; font-size: 20px; }
        .header h1 { font-size: 20px; font-weight: 700; }
        .header p { color: #9ca3af; font-size: 14px; }
        .header-right { display: flex; align-items: center; gap: 16px; }
        .header-info { text-align: right; }
        .header-info .name { color: #9ca3af; font-size: 14px; }
        .header-info .id { color: #6b7280; font-size: 12px; }
        .status-badge { background: rgba(16, 185, 129, 0.2); color: #34d399; padding: 6px 12px; border-radius: 20px; font-size: 13px; display: flex; align-items: center; gap: 6px; }
        .dissertation-title { background: rgba(59, 130, 246, 0.1); border: 1px solid rgba(59, 130, 246, 0.3); border-radius: 8px; padding: 12px 16px; margin-top: 12px; }
        .dissertation-title h2 { font-size: 14px; font-weight: 600; color: #60a5fa; margin-bottom: 4px; }
        .dissertation-title p { font-size: 13px; color: #9ca3af; line-height: 1.4; }
        .classification-badge { background: rgba(239, 68, 68, 0.2); color: #f87171; padding: 6px 12px; border-radius: 20px; font-size: 12px; font-weight: 600; margin-top: 8px; display: inline-block; }
        .nav { background: #1f2937; padding: 0 24px; border-bottom: 1px solid #374151; overflow-x: auto; }
        .nav-tabs { display: flex; gap: 4px; }
        .nav-tab { padding: 12px 16px; border: none; background: transparent; color: #9ca3af; font-size: 14px; font-weight: 500; cursor: pointer; border-bottom: 2px solid transparent; transition: all 0.2s; white-space: nowrap; }
        .nav-tab:hover { color: #fff; background: #374151; }
        .nav-tab.active { color: #fff; background: #111827; border-bottom-color: #3b82f6; }
        .main { padding: 24px; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .card { background: #1f2937; border-radius: 12px; padding: 20px; border: 1px solid #374151; margin-bottom: 24px; }
        .card h3 { font-size: 18px; font-weight: 600; margin-bottom: 16px; display: flex; align-items: center; gap: 8px; }
        .grid-4 { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 16px; margin-bottom: 24px; }
        .grid-3 { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 16px; margin-bottom: 24px; }
        .grid-2 { display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 24px; margin-bottom: 24px; }
        .stat-card { background: #1f2937; border-radius: 12px; padding: 20px; border: 1px solid #374151; }
        .stat-card .label { color: #9ca3af; font-size: 14px; }
        .stat-card .value { font-size: 28px; font-weight: 700; margin: 8px 0 4px; }
        .stat-card .subtitle { color: #6b7280; font-size: 12px; }
        .dataset-card { background: rgba(55, 65, 81, 0.5); border-radius: 12px; padding: 20px; border: 1px solid #4b5563; transition: all 0.2s; }
        .dataset-card:hover { border-color: #6b7280; transform: translateY(-2px); }
        .dataset-card .icon { font-size: 32px; margin-bottom: 12px; }
        .badge { display: inline-block; padding: 4px 10px; border-radius: 12px; font-size: 12px; font-weight: 500; }
        .badge.green { background: rgba(16, 185, 129, 0.2); color: #34d399; }
        .badge.red { background: rgba(239, 68, 68, 0.2); color: #f87171; }
        .badge.blue { background: rgba(59, 130, 246, 0.2); color: #60a5fa; }
        .badge.purple { background: rgba(139, 92, 246, 0.2); color: #a78bfa; }
        .badge.gray { background: rgba(107, 114, 128, 0.2); color: #9ca3af; }
        .badge.cyan { background: rgba(6, 182, 212, 0.2); color: #22d3ee; }
        .badge.orange { background: rgba(249, 115, 22, 0.2); color: #fb923c; }
        .chart-container { position: relative; height: 300px; margin-top: 16px; }
        .chart-container-lg { position: relative; height: 350px; margin-top: 16px; }
        .chart-container-xl { position: relative; height: 500px; margin-top: 16px; }
        .info-box { padding: 16px; border-radius: 8px; margin-bottom: 12px; }
        .info-box.purple { background: rgba(139, 92, 246, 0.15); border: 1px solid rgba(139, 92, 246, 0.3); }
        .info-box.blue { background: rgba(59, 130, 246, 0.15); border: 1px solid rgba(59, 130, 246, 0.3); }
        .info-box.green { background: rgba(16, 185, 129, 0.15); border: 1px solid rgba(16, 185, 129, 0.3); }
        .info-box.red { background: rgba(239, 68, 68, 0.15); border: 1px solid rgba(239, 68, 68, 0.3); }
        .info-box.cyan { background: rgba(6, 182, 212, 0.15); border: 1px solid rgba(6, 182, 212, 0.3); }
        .pipeline { display: flex; align-items: center; justify-content: center; gap: 16px; flex-wrap: wrap; padding: 20px 0; }
        .pipeline-step { text-align: center; padding: 20px; border-radius: 12px; min-width: 160px; }
        .pipeline-step.purple { background: rgba(139, 92, 246, 0.15); border: 1px solid rgba(139, 92, 246, 0.3); }
        .pipeline-step.blue { background: rgba(59, 130, 246, 0.15); border: 1px solid rgba(59, 130, 246, 0.3); }
        .pipeline-step.green { background: rgba(16, 185, 129, 0.15); border: 1px solid rgba(16, 185, 129, 0.3); }
        .pipeline-step.cyan { background: rgba(6, 182, 212, 0.15); border: 1px solid rgba(6, 182, 212, 0.3); }
        .pipeline-step.orange { background: rgba(249, 115, 22, 0.15); border: 1px solid rgba(249, 115, 22, 0.3); }
        .pipeline-step .step-icon { font-size: 32px; margin-bottom: 10px; }
        .pipeline-step h4 { font-weight: 700; margin-bottom: 4px; font-size: 14px; }
        .pipeline-step.purple h4 { color: #a78bfa; }
        .pipeline-step.blue h4 { color: #60a5fa; }
        .pipeline-step.green h4 { color: #34d399; }
        .pipeline-step.cyan h4 { color: #22d3ee; }
        .pipeline-step.orange h4 { color: #fb923c; }
        .pipeline-step p { font-size: 12px; color: #9ca3af; }
        .pipeline-arrow { font-size: 28px; color: #4b5563; }
        .table-container { overflow-x: auto; }
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 12px 16px; text-align: left; border-bottom: 1px solid #374151; }
        th { color: #9ca3af; font-weight: 600; font-size: 13px; }
        td { font-size: 14px; }
        tr:hover { background: rgba(55, 65, 81, 0.5); }
        tr.highlight { background: rgba(59, 130, 246, 0.1); }
        .feature-list { display: flex; flex-wrap: wrap; gap: 6px; margin-top: 8px; }
        .feature-tag { background: #374151; padding: 4px 8px; border-radius: 4px; font-size: 11px; color: #d1d5db; }
        .feature-tag.purple { background: rgba(139, 92, 246, 0.3); color: #a78bfa; }
        .feature-tag.blue { background: rgba(59, 130, 246, 0.3); color: #60a5fa; }
        .feature-tag.green { background: rgba(16, 185, 129, 0.3); color: #34d399; }
        .contribution-list { list-style: none; padding: 0; margin-top: 12px; }
        .contribution-list li { font-size: 13px; color: #9ca3af; padding: 4px 0; display: flex; align-items: flex-start; gap: 8px; }
        .contribution-list li::before { content: "‚úì"; color: #34d399; }
        .data-summary { display: grid; grid-template-columns: repeat(auto-fit, minmax(80px, 1fr)); gap: 12px; margin-top: 16px; padding: 16px; background: rgba(55, 65, 81, 0.3); border-radius: 8px; }
        .data-summary-item { text-align: center; }
        .data-summary-item .value { font-size: 16px; font-weight: 700; color: #60a5fa; }
        .data-summary-item .label { font-size: 10px; color: #9ca3af; }
        .final-dataset-card { background: linear-gradient(135deg, rgba(6, 182, 212, 0.15) 0%, rgba(59, 130, 246, 0.15) 100%); border: 2px solid rgba(6, 182, 212, 0.5); border-radius: 16px; padding: 24px; margin-bottom: 24px; }
        .final-dataset-header { display: flex; align-items: center; gap: 16px; margin-bottom: 20px; }
        .final-dataset-icon { font-size: 48px; }
        .final-dataset-title h3 { font-size: 24px; color: #22d3ee; margin-bottom: 4px; }
        .final-dataset-title p { color: #9ca3af; font-size: 14px; }
        .final-dataset-stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 16px; }
        .final-stat { background: rgba(17, 24, 39, 0.6); padding: 16px; border-radius: 12px; text-align: center; }
        .final-stat .value { font-size: 28px; font-weight: 700; color: #22d3ee; }
        .final-stat .label { font-size: 12px; color: #9ca3af; margin-top: 4px; }
        .predictor-section { padding: 16px; border-radius: 8px; margin-bottom: 16px; }
        .predictor-section.purple { background: rgba(139, 92, 246, 0.1); border: 1px solid rgba(139, 92, 246, 0.3); }
        .predictor-section.blue { background: rgba(59, 130, 246, 0.1); border: 1px solid rgba(59, 130, 246, 0.3); }
        .predictor-section .section-title { font-size: 12px; font-weight: 600; margin-bottom: 12px; }
        .predictor-section.purple .section-title { color: #a78bfa; }
        .predictor-section.blue .section-title { color: #60a5fa; }
        .form-group { margin-bottom: 12px; }
        .form-group label { display: block; font-size: 13px; color: #9ca3af; margin-bottom: 4px; }
        .form-group input, .form-group select { width: 100%; padding: 10px 12px; background: #374151; border: 1px solid #4b5563; border-radius: 8px; color: #fff; font-size: 14px; }
        .form-group input:focus, .form-group select:focus { outline: none; border-color: #3b82f6; }
        .btn-predict { width: 100%; padding: 14px; background: #2563eb; border: none; border-radius: 8px; color: #fff; font-size: 15px; font-weight: 600; cursor: pointer; transition: background 0.2s; }
        .btn-predict:hover { background: #1d4ed8; }
        .prediction-result { padding: 24px; border-radius: 12px; margin-top: 24px; }
        .prediction-result.at-risk { background: #1f2937; border: 2px solid #ef4444; }
        .prediction-result.not-risk { background: #1f2937; border: 2px solid #10b981; }
        .result-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; margin-top: 16px; }
        .result-item { text-align: center; padding: 16px; background: rgba(55, 65, 81, 0.5); border-radius: 8px; }
        .result-item .label { font-size: 13px; color: #9ca3af; margin-bottom: 8px; }
        .result-item .value { font-size: 24px; font-weight: 700; }
        .footer { background: #1f2937; border-top: 1px solid #374151; padding: 16px 24px; display: flex; justify-content: space-between; flex-wrap: wrap; gap: 8px; font-size: 13px; color: #9ca3af; }
        .feature-comparison-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 24px; }
        .feature-chart-card { background: rgba(55, 65, 81, 0.3); border-radius: 12px; padding: 16px; border: 1px solid #4b5563; }
        .feature-chart-card h4 { font-size: 14px; font-weight: 600; margin-bottom: 12px; color: #d1d5db; }
        .engineered-features-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px; margin-top: 16px; }
        .eng-feature { background: rgba(55, 65, 81, 0.5); padding: 12px; border-radius: 8px; border-left: 3px solid #3b82f6; }
        .eng-feature.equipment { border-left-color: #8b5cf6; }
        .eng-feature.jobs { border-left-color: #3b82f6; }
        .eng-feature.services { border-left-color: #10b981; }
        .eng-feature .name { font-weight: 600; font-size: 13px; }
        .eng-feature .source { font-size: 11px; color: #9ca3af; margin-top: 4px; }
        .datasets-summary-table { margin-top: 16px; }
        .datasets-summary-table table { background: rgba(55, 65, 81, 0.3); border-radius: 8px; overflow: hidden; }
        .datasets-summary-table th { background: rgba(55, 65, 81, 0.5); }
        @media (max-width: 768px) { .header-top { flex-direction: column; align-items: flex-start; } .grid-2, .grid-3, .grid-4 { grid-template-columns: 1fr; } .pipeline { flex-direction: column; } .pipeline-arrow { transform: rotate(90deg); } .result-grid { grid-template-columns: 1fr; } .feature-comparison-grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-top">
            <div class="header-left">
                <div class="header-icon">‚ö°</div>
                <div>
                    <h1>WB Power Services - Equipment Failure Prediction</h1>
                    <p>LightGBM ML Model Dashboard | MSc Dissertation Project</p>
                </div>
            </div>
            <div class="header-right">
                <div class="header-info">
                    <p class="name">Simon Akporowhe</p>
                    <p class="id">Student ID: 24044525</p>
                </div>
                <div class="status-badge"><span>‚úì</span> Model Active</div>
            </div>
        </div>
        <div class="dissertation-title">
            <h2>üìö MSc Dissertation</h2>
            <p>Developing an Advanced Machine Learning Algorithm for Equipment Failure Prediction: A Case Study of WB Power Services Ltd Using Protean System Data</p>
            
        </div>
    </header>
    
    <nav class="nav">
        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('overview', this)">üìä Overview</button>
            <button class="nav-tab" onclick="showTab('datasets', this)">üóÑÔ∏è Data Sources</button>
            <button class="nav-tab" onclick="showTab('models', this)">ü§ñ Model Performance</button>
            <button class="nav-tab" onclick="showTab('features', this)">üìà Feature Analysis</button>
            <button class="nav-tab" onclick="showTab('patterns', this)">üìâ Risk Patterns</button>
            <button class="nav-tab" onclick="showTab('predict', this)">üéØ Risk Predictor</button>
        </div>
    </nav>
    
    <main class="main">
        <div id="overview" class="tab-content active">
            <!-- Final Merged Dataset Card -->
            <div class="final-dataset-card">
                <div class="final-dataset-header">
                    <div class="final-dataset-icon">üéØ</div>
                    <div class="final-dataset-title">
                        <h3>equipment_df - Final Merged Dataset</h3>
                        <p>Single unified dataset with binary target: 0 = Not at Risk | 1 = At Risk</p>
                    </div>
                </div>
                <div class="final-dataset-stats">
                    <div class="final-stat">
                        <div class="value">20,233</div>
                        <div class="label">Rows (Equipment Records)</div>
                    </div>
                    <div class="final-stat">
                        <div class="value">92</div>
                        <div class="label">Total Columns</div>
                    </div>
                    <div class="final-stat">
                        <div class="value">14</div>
                        <div class="label">Engineered Features</div>
                    </div>
                    <div class="final-stat">
                        <div class="value">2</div>
                        <div class="label">Target Classes</div>
                    </div>
                </div>
                <div style="margin-top: 20px; padding: 16px; background: rgba(17, 24, 39, 0.6); border-radius: 12px;">
                    <p style="color: #22d3ee; font-weight: 600; margin-bottom: 12px;">üìê Final Shape: (20,233 √ó 92)</p>
                    <p style="color: #9ca3af; font-size: 13px;">The final <code style="background: #374151; padding: 2px 6px; border-radius: 4px;">equipment_df</code> DataFrame combines base equipment attributes with engineered features derived from job history and service records for predictive maintenance analysis.</p>
                </div>
            </div>
            
            <!-- Three Merged Datasets Summary Table -->
            <div class="card">
                <h3>üìä Three Merged Datasets Summary</h3>
                <div class="datasets-summary-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Dataset</th>
                                <th style="text-align:right">Rows</th>
                                <th style="text-align:right">Columns</th>
                                <th style="text-align:right">Memory (MB)</th>
                                <th style="text-align:right">Missing %</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><span class="badge purple">üîß Equipment-Centric</span></td>
                                <td style="text-align:right;font-weight:600">20,233</td>
                                <td style="text-align:right">78</td>
                                <td style="text-align:right">34.58</td>
                                <td style="text-align:right;color:#f87171">43.11%</td>
                            </tr>
                            <tr>
                                <td><span class="badge blue">üìã Job-Centric</span></td>
                                <td style="text-align:right;font-weight:600">461,113</td>
                                <td style="text-align:right">110</td>
                                <td style="text-align:right">967.27</td>
                                <td style="text-align:right;color:#fbbf24">32.55%</td>
                            </tr>
                            <tr>
                                <td><span class="badge green">üîÑ Service History</span></td>
                                <td style="text-align:right;font-weight:600">883,470</td>
                                <td style="text-align:right">16</td>
                                <td style="text-align:right">452.29</td>
                                <td style="text-align:right;color:#34d399">8.07%</td>
                            </tr>
                            <tr style="background: rgba(59, 130, 246, 0.1); font-weight: 600;">
                                <td>üìä Total</td>
                                <td style="text-align:right">1,364,816</td>
                                <td style="text-align:right">204</td>
                                <td style="text-align:right">1,454.14</td>
                                <td style="text-align:right">-</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div class="grid-4">
                <div class="stat-card"><div class="label">Equipment Records</div><div class="value" style="color: #a78bfa;">20,233</div><div class="subtitle">78 columns ‚Ä¢ 34.58 MB</div></div>
                <div class="stat-card"><div class="label">Job Records</div><div class="value" style="color: #60a5fa;">461,113</div><div class="subtitle">110 columns ‚Ä¢ 967.27 MB</div></div>
                <div class="stat-card"><div class="label">Service History Records</div><div class="value" style="color: #34d399;">883,470</div><div class="subtitle">16 columns ‚Ä¢ 452.29 MB</div></div>
                <div class="stat-card"><div class="label">Source Tables</div><div class="value" style="color: #9ca3af;">17</div><div class="subtitle">Protean System</div></div>
            </div>
            <div class="grid-4">
                <div class="stat-card"><div class="label">Best Model F1</div><div class="value" style="color: #34d399;">96.52%</div><div class="subtitle">LightGBM (Binary)</div></div>
                <div class="stat-card"><div class="label">HDG Failure Rate</div><div class="value" style="color: #f87171;">74.95%</div><div class="subtitle">Critical Finding</div></div>
                <div class="stat-card"><div class="label">ROC AUC</div><div class="value" style="color: #22d3ee;">98.71%</div><div class="subtitle">LightGBM</div></div>
                <div class="stat-card"><div class="label">At Risk Equipment</div><div class="value" style="color: #fbbf24;">1,648</div><div class="subtitle">8.14% of Fleet</div></div>
            </div>
            
            <!-- Three Merged Datasets Visualization -->
            <div class="card">
                <h3>üìä WB Power Services - Three Merged Datasets Overview</h3>
                <div class="grid-3">
                    <div>
                        <h4 style="text-align: center; color: #9ca3af; font-size: 14px; margin-bottom: 12px;">Dataset Sizes</h4>
                        <div class="chart-container"><canvas id="datasetSizesChart"></canvas></div>
                    </div>
                    <div>
                        <h4 style="text-align: center; color: #9ca3af; font-size: 14px; margin-bottom: 12px;">Record Distribution</h4>
                        <div class="chart-container"><canvas id="recordDistChart"></canvas></div>
                    </div>
                    <div>
                        <h4 style="text-align: center; color: #9ca3af; font-size: 14px; margin-bottom: 12px;">Source Tables per Dataset</h4>
                        <div class="chart-container"><canvas id="sourceTablesPerDataset"></canvas></div>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <h3>üîÄ Data Merging Pipeline ‚Üí Final equipment_df</h3>
                <div class="pipeline">
                    <div class="pipeline-step purple">
                        <div class="step-icon">üîß</div>
                        <h4>Equipment Dataset</h4>
                        <p>20,233 rows √ó 78 cols</p>
                        <p style="font-size: 10px; margin-top: 4px;">34.58 MB ‚Ä¢ 43.11% missing</p>
                    </div>
                    <div class="pipeline-arrow">+</div>
                    <div class="pipeline-step blue">
                        <div class="step-icon">üìã</div>
                        <h4>Jobs Dataset</h4>
                        <p>461,113 rows √ó 110 cols</p>
                        <p style="font-size: 10px; margin-top: 4px;">967.27 MB ‚Ä¢ 32.55% missing</p>
                    </div>
                    <div class="pipeline-arrow">+</div>
                    <div class="pipeline-step green">
                        <div class="step-icon">üîÑ</div>
                        <h4>Services Dataset</h4>
                        <p>883,470 rows √ó 16 cols</p>
                        <p style="font-size: 10px; margin-top: 4px;">452.29 MB ‚Ä¢ 8.07% missing</p>
                    </div>
                    <div class="pipeline-arrow">‚Üí</div>
                    <div class="pipeline-step orange">
                        <div class="step-icon">‚öôÔ∏è</div>
                        <h4>Feature Engineering</h4>
                        <p>+14 New Features</p>
                        <p style="font-size: 10px; margin-top: 4px;">Derived metrics</p>
                    </div>
                    <div class="pipeline-arrow">‚Üí</div>
                    <div class="pipeline-step cyan">
                        <div class="step-icon">üéØ</div>
                        <h4>equipment_df (Binary)</h4>
                        <p style="color: #22d3ee; font-weight: 700;">20,233 √ó 92</p>
                        <p style="font-size: 10px; margin-top: 4px;">2 Target Classes</p>
                    </div>
                </div>
            </div>
            
            <div class="grid-2">
                <div class="card"><h3>üìä Binary Risk Distribution</h3><div class="chart-container"><canvas id="classDistChart"></canvas></div></div>
                <div class="card"><h3>üèÜ Top Model Performance (F1 Score)</h3><div class="chart-container"><canvas id="modelPerfChart"></canvas></div></div>
            </div>
            <div class="card">
                <h3>‚ö†Ô∏è HDG vs Non-HDG Equipment Analysis</h3>
                <div class="grid-2">
                    <div class="chart-container"><canvas id="hdgChart"></canvas></div>
                    <div style="display: flex; flex-direction: column; justify-content: center; gap: 16px;">
                        <div class="info-box red">
                            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;"><span>‚ö†Ô∏è</span><span style="color: #f87171; font-weight: 600;">Critical Finding</span></div>
                            <div style="font-size: 32px; font-weight: 700;">12.9x Higher Risk</div>
                            <p style="color: #9ca3af; font-size: 13px;">HDG equipment failure rate vs Non-HDG</p>
                        </div>
                        <div class="grid-2" style="margin-bottom: 0;">
                            <div style="text-align: center; padding: 16px; background: rgba(55,65,81,0.5); border-radius: 8px;"><p style="color: #9ca3af; font-size: 12px;">HDG Fleet Share</p><p style="font-size: 24px; font-weight: 700;">7.02%</p></div>
                            <div style="text-align: center; padding: 16px; background: rgba(55,65,81,0.5); border-radius: 8px;"><p style="color: #9ca3af; font-size: 12px;">HDG Failure Rate</p><p style="font-size: 24px; font-weight: 700; color: #f87171;">74.95%</p></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="datasets" class="tab-content">
            <!-- Final Merged Dataset Highlight -->
            <div class="final-dataset-card">
                <div class="final-dataset-header">
                    <div class="final-dataset-icon">üéØ</div>
                    <div class="final-dataset-title">
                        <h3>equipment_df - Final Merged Dataset for ML</h3>
                        <p>0 = Not at Risk, 1 = At Risk</p>
                    </div>
                </div>
                <div class="final-dataset-stats">
                    <div class="final-stat">
                        <div class="value">20,233</div>
                        <div class="label">Rows</div>
                    </div>
                    <div class="final-stat">
                        <div class="value">92</div>
                        <div class="label">Columns</div>
                    </div>
                    <div class="final-stat">
                        <div class="value">14</div>
                        <div class="label">Engineered Features</div>
                    </div>
                </div>
            </div>
            
            <!-- Three Merged Datasets Summary Table -->
            <div class="card">
                <h3>üìä Three Merged Datasets Summary</h3>
                <div class="datasets-summary-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Dataset</th>
                                <th style="text-align:right">Rows</th>
                                <th style="text-align:right">Columns</th>
                                <th style="text-align:right">Memory (MB)</th>
                                <th style="text-align:right">Missing %</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><span class="badge purple">üîß Equipment-Centric</span></td>
                                <td style="text-align:right;font-weight:600">20,233</td>
                                <td style="text-align:right">78</td>
                                <td style="text-align:right">34.58</td>
                                <td style="text-align:right;color:#f87171">43.11%</td>
                            </tr>
                            <tr>
                                <td><span class="badge blue">üìã Job-Centric</span></td>
                                <td style="text-align:right;font-weight:600">461,113</td>
                                <td style="text-align:right">110</td>
                                <td style="text-align:right">967.27</td>
                                <td style="text-align:right;color:#fbbf24">32.55%</td>
                            </tr>
                            <tr>
                                <td><span class="badge green">üîÑ Service History</span></td>
                                <td style="text-align:right;font-weight:600">883,470</td>
                                <td style="text-align:right">16</td>
                                <td style="text-align:right">452.29</td>
                                <td style="text-align:right;color:#34d399">8.07%</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div class="grid-3">
                <div class="card" style="border-left: 4px solid #8b5cf6;">
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 16px;"><span style="font-size: 48px;">üîß</span><span class="badge purple">20,233 rows</span></div>
                    <h3 style="margin-bottom: 8px;">Equipment-Centric Dataset</h3>
                    <p style="color: #9ca3af; font-size: 14px; margin-bottom: 16px;">Base dataset with equipment attributes - forms the backbone of equipment_df</p>
                    <div style="margin-bottom: 16px;"><p style="color: #6b7280; font-size: 11px; text-transform: uppercase; margin-bottom: 8px;">File</p><code style="background: #374151; padding: 6px 10px; border-radius: 4px; display: block;">merged_data_equipment.csv</code></div>
                    <div class="data-summary">
                        <div class="data-summary-item"><div class="value">78</div><div class="label">Columns</div></div>
                        <div class="data-summary-item"><div class="value">34.58</div><div class="label">MB</div></div>
                        <div class="data-summary-item"><div class="value" style="color:#f87171">43.11%</div><div class="label">Missing</div></div>
                        <div class="data-summary-item"><div class="value">4</div><div class="label">Tables</div></div>
                    </div>
                </div>
                <div class="card" style="border-left: 4px solid #3b82f6;">
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 16px;"><span style="font-size: 48px;">üìã</span><span class="badge blue">461,113 rows</span></div>
                    <h3 style="margin-bottom: 8px;">Job-Centric Dataset</h3>
                    <p style="color: #9ca3af; font-size: 14px; margin-bottom: 16px;">Job records aggregated per EquipmentID for maintenance patterns</p>
                    <div style="margin-bottom: 16px;"><p style="color: #6b7280; font-size: 11px; text-transform: uppercase; margin-bottom: 8px;">File</p><code style="background: #374151; padding: 6px 10px; border-radius: 4px; display: block;">merged_data_jobs.csv</code></div>
                    <div class="data-summary">
                        <div class="data-summary-item"><div class="value">110</div><div class="label">Columns</div></div>
                        <div class="data-summary-item"><div class="value">967.27</div><div class="label">MB</div></div>
                        <div class="data-summary-item"><div class="value" style="color:#fbbf24">32.55%</div><div class="label">Missing</div></div>
                        <div class="data-summary-item"><div class="value">8</div><div class="label">Tables</div></div>
                    </div>
                </div>
                <div class="card" style="border-left: 4px solid #10b981;">
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 16px;"><span style="font-size: 48px;">üîÑ</span><span class="badge green">883,470 rows</span></div>
                    <h3 style="margin-bottom: 8px;">Service History-Centric Dataset</h3>
                    <p style="color: #9ca3af; font-size: 14px; margin-bottom: 16px;">Service records aggregated per EquipmentID for parts analysis</p>
                    <div style="margin-bottom: 16px;"><p style="color: #6b7280; font-size: 11px; text-transform: uppercase; margin-bottom: 8px;">File</p><code style="background: #374151; padding: 6px 10px; border-radius: 4px; display: block;">merged_data_services.csv</code></div>
                    <div class="data-summary">
                        <div class="data-summary-item"><div class="value">16</div><div class="label">Columns</div></div>
                        <div class="data-summary-item"><div class="value">452.29</div><div class="label">MB</div></div>
                        <div class="data-summary-item"><div class="value" style="color:#34d399">8.07%</div><div class="label">Missing</div></div>
                        <div class="data-summary-item"><div class="value">5</div><div class="label">Tables</div></div>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <h3>üîÄ Data Integration Pipeline ‚Üí equipment_df (20,233 √ó 92)</h3>
                <div class="pipeline">
                    <div class="pipeline-step purple"><div class="step-icon">üóÑÔ∏è</div><h4>17 Source Tables</h4><p>Protean System</p><p style="font-size: 10px; margin-top: 4px;">3,970,500 rows loaded</p></div>
                    <div class="pipeline-arrow">‚Üí</div>
                    <div class="pipeline-step blue"><div class="step-icon">‚öôÔ∏è</div><h4>ETL Process</h4><p>Cleaning & Merging</p><p style="font-size: 10px; margin-top: 4px;">Python/Pandas</p></div>
                    <div class="pipeline-arrow">‚Üí</div>
                    <div class="pipeline-step green"><div class="step-icon">üìä</div><h4>3 Merged Datasets</h4><p>Intermediate Files</p><div style="font-size: 10px; margin-top: 4px;"><p>Equipment: 20,233 √ó 78</p><p>Jobs: 461,113 √ó 110</p><p>Services: 883,470 √ó 16</p></div></div>
                    <div class="pipeline-arrow">‚Üí</div>
                    <div class="pipeline-step orange"><div class="step-icon">üîß</div><h4>Feature Engineering</h4><p>+14 Features</p><p style="font-size: 10px; margin-top: 4px;">Aggregation & Derivation</p></div>
                    <div class="pipeline-arrow">‚Üí</div>
                    <div class="pipeline-step cyan"><div class="step-icon">üéØ</div><h4>equipment_df (Binary)</h4><p style="color: #22d3ee; font-weight: 700; font-size: 14px;">20,233 √ó 92</p><p style="font-size: 10px; margin-top: 4px;">2 Target Classes</p></div>
                </div>
            </div>
            
            <div class="card">
                <h3>üìà Source Table Record Counts (17 Tables)</h3>
                <div class="chart-container-xl"><canvas id="sourceTableChart"></canvas></div>
            </div>
            <div class="card">
                <h3>üóÑÔ∏è 17 Source Tables from Protean System</h3>
                <div class="table-container"><table><thead><tr><th>Table Name</th><th style="text-align:right">Rows</th><th style="text-align:center">Columns</th><th style="text-align:right">File Size</th><th>Category</th><th>Merges To</th></tr></thead><tbody id="sourceTablesBody"></tbody></table></div>
                <div style="margin-top: 20px; padding: 16px; background: rgba(59, 130, 246, 0.1); border: 1px solid rgba(59, 130, 246, 0.3); border-radius: 8px;">
                    <h4 style="margin-bottom: 12px; color: #60a5fa;">üìä Data Summary</h4>
                    <div class="grid-4" style="margin-bottom: 0;">
                        <div style="text-align: center;"><div style="font-size: 24px; font-weight: 700; color: #60a5fa;">3,970,500</div><div style="font-size: 12px; color: #9ca3af;">Total Source Rows</div></div>
                        <div style="text-align: center;"><div style="font-size: 24px; font-weight: 700; color: #a78bfa;">17</div><div style="font-size: 12px; color: #9ca3af;">Source Tables</div></div>
                        <div style="text-align: center;"><div style="font-size: 24px; font-weight: 700; color: #22d3ee;">20,233 √ó 92</div><div style="font-size: 12px; color: #9ca3af;">Final equipment_df Shape</div></div>
                        <div style="text-align: center;"><div style="font-size: 24px; font-weight: 700; color: #fbbf24;">10 Years</div><div style="font-size: 12px; color: #9ca3af;">Data Span</div></div>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="models" class="tab-content">
            <div class="card">
                <h3>üèÜ Model Performance Comparison</h3>
                <p style="color: #9ca3af; font-size: 13px; margin-bottom: 16px;">Models trained on equipment_df (20,233 √ó 92) with binary target variable</p>
                <div class="table-container">
                    <table>
                        <thead><tr><th>Rank</th><th>Model</th><th style="text-align:right">F1 Score</th><th style="text-align:right">Accuracy</th><th style="text-align:right">ROC AUC</th><th style="text-align:right">Overfit Gap</th><th>Status</th></tr></thead>
                        <tbody>
                            <tr class="highlight"><td>ü•á</td><td><strong>LightGBM</strong></td><td style="text-align:right;color:#34d399;font-weight:700">96.52%</td><td style="text-align:right">96.41%</td><td style="text-align:right">98.71%</td><td style="text-align:right;color:#34d399">1.91%</td><td><span class="badge green">Best</span></td></tr>
                            <tr><td>ü•à</td><td>Random Forest</td><td style="text-align:right">96.31%</td><td style="text-align:right">96.28%</td><td style="text-align:right">98.56%</td><td style="text-align:right;color:#34d399">2.18%</td><td><span class="badge blue">Good</span></td></tr>
                            <tr><td>ü•â</td><td>Gradient Boosting</td><td style="text-align:right">96.22%</td><td style="text-align:right">96.19%</td><td style="text-align:right">98.47%</td><td style="text-align:right;color:#34d399">2.31%</td><td><span class="badge blue">Good</span></td></tr>
                            <tr><td>4</td><td>Neural Network</td><td style="text-align:right">95.84%</td><td style="text-align:right">95.73%</td><td style="text-align:right">98.23%</td><td style="text-align:right;color:#34d399">2.54%</td><td><span class="badge blue">Good</span></td></tr>
                            <tr><td>5</td><td>AdaBoost</td><td style="text-align:right">95.47%</td><td style="text-align:right">95.34%</td><td style="text-align:right">97.84%</td><td style="text-align:right;color:#34d399">2.89%</td><td><span class="badge blue">Good</span></td></tr>
                            <tr><td>6</td><td>Logistic Regression</td><td style="text-align:right">94.23%</td><td style="text-align:right">94.01%</td><td style="text-align:right">96.58%</td><td style="text-align:right;color:#34d399">1.76%</td><td><span class="badge gray">Fair</span></td></tr>
                            <tr><td>7</td><td>SVM</td><td style="text-align:right">91.56%</td><td style="text-align:right">91.23%</td><td style="text-align:right">94.12%</td><td style="text-align:right;color:#34d399">2.67%</td><td><span class="badge gray">Fair</span></td></tr>
                            <tr><td>8</td><td>KNN</td><td style="text-align:right">87.34%</td><td style="text-align:right">86.51%</td><td style="text-align:right">90.87%</td><td style="text-align:right;color:#fbbf24">3.12%</td><td><span class="badge gray">Baseline</span></td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="grid-2">
                <div class="card">
                    <h3>üìä F1 Score Comparison</h3>
                    <div class="chart-container-lg"><canvas id="f1CompChart"></canvas></div>
                </div>
                <div class="card">
                    <h3>üìà ROC AUC Comparison</h3>
                    <div class="chart-container-lg"><canvas id="rocCompChart"></canvas></div>
                </div>
            </div>
            <div class="card">
                <h3>üéØ LightGBM - Best Model Details</h3>
                <div class="grid-4">
                    <div class="info-box green">
                        <p style="color: #9ca3af; font-size: 12px;">F1 Score</p>
                        <p style="font-size: 32px; font-weight: 700; color: #34d399;">96.52%</p>
                    </div>
                    <div class="info-box blue">
                        <p style="color: #9ca3af; font-size: 12px;">Accuracy</p>
                        <p style="font-size: 32px; font-weight: 700; color: #60a5fa;">96.41%</p>
                    </div>
                    <div class="info-box purple">
                        <p style="color: #9ca3af; font-size: 12px;">ROC AUC</p>
                        <p style="font-size: 32px; font-weight: 700; color: #a78bfa;">98.71%</p>
                    </div>
                    <div class="info-box green">
                        <p style="color: #9ca3af; font-size: 12px;">Overfit Gap</p>
                        <p style="font-size: 32px; font-weight: 700; color: #34d399;">1.91%</p>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="features" class="tab-content">
            <div class="card">
                <h3>üìä Feature Importance Comparison Across Models</h3>
                <p style="color: #9ca3af; font-size: 13px; margin-bottom: 20px;">Comparison of the 14 engineered features in equipment_df across Random Forest, Gradient Boosting, LightGBM, and AdaBoost models</p>
                <div class="feature-comparison-grid">
                    <div class="feature-chart-card">
                        <h4>üå≤ Random Forest</h4>
                        <div class="chart-container-lg"><canvas id="rfFeatureChart"></canvas></div>
                    </div>
                    <div class="feature-chart-card">
                        <h4>üìà Gradient Boosting</h4>
                        <div class="chart-container-lg"><canvas id="gbFeatureChart"></canvas></div>
                    </div>
                    <div class="feature-chart-card">
                        <h4>‚ö° LightGBM</h4>
                        <div class="chart-container-lg"><canvas id="lgbFeatureChart"></canvas></div>
                    </div>
                    <div class="feature-chart-card">
                        <h4>üöÄ AdaBoost</h4>
                        <div class="chart-container-lg"><canvas id="adaFeatureChart"></canvas></div>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <h3>üîë Key Feature Insights from equipment_df</h3>
                <div class="grid-3">
                    <div class="info-box purple">
                        <h4 style="color: #a78bfa; margin-bottom: 12px;">üèÜ Top Feature</h4>
                        <p style="font-size: 24px; font-weight: 700;">Status</p>
                        <p style="color: #9ca3af; font-size: 13px; margin-top: 8px;">Consistently ranked #1 across all four models</p>
                    </div>
                    <div class="info-box blue">
                        <h4 style="color: #60a5fa; margin-bottom: 12px;">üìä Equipment Attributes</h4>
                        <p style="font-size: 18px; font-weight: 600;">make_model_id, equipment_age, capitalisation_cost</p>
                        <p style="color: #9ca3af; font-size: 13px; margin-top: 8px;">Equipment-centric features contribute ~52%</p>
                    </div>
                    <div class="info-box green">
                        <h4 style="color: #34d399; margin-bottom: 12px;">üìã Job Features</h4>
                        <p style="font-size: 18px; font-weight: 600;">jobs_per_year, days_since_last_job, total_jobs</p>
                        <p style="color: #9ca3af; font-size: 13px; margin-top: 8px;">Job-centric features contribute ~35%</p>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <h3>üìà Feature Importance by Source Dataset</h3>
                <div class="chart-container-lg"><canvas id="datasetContribChart"></canvas></div>
            </div>
        </div>
        
        <div id="patterns" class="tab-content">
            <div class="card">
                <h3>üìâ Equipment Failure Bathtub Curve</h3>
                <div class="chart-container-lg"><canvas id="bathtubChart"></canvas></div>
                <div class="grid-3" style="margin-top: 20px;">
                    <div class="info-box red">
                        <h4 style="color: #f87171;">Infant Mortality (1-3 years)</h4>
                        <p style="font-size: 28px; font-weight: 700;">2.25%</p>
                        <p style="color: #9ca3af; font-size: 12px;">Peak failure rate period</p>
                    </div>
                    <div class="info-box green">
                        <h4 style="color: #34d399;">Useful Life (5-10 years)</h4>
                        <p style="font-size: 28px; font-weight: 700;">0.80%</p>
                        <p style="color: #9ca3af; font-size: 12px;">Lowest failure rate</p>
                    </div>
                    <div class="info-box blue">
                        <h4 style="color: #60a5fa;">Risk Multiplier</h4>
                        <p style="font-size: 28px; font-weight: 700;">2.8x</p>
                        <p style="color: #9ca3af; font-size: 12px;">Peak vs minimum rate ratio</p>
                    </div>
                </div>
            </div>
            <div class="card">
                <h3>üìä Status Code Analysis</h3>
                <div class="chart-container-lg"><canvas id="statusCodeChart"></canvas></div>
            </div>
        </div>
        
        <div id="predict" class="tab-content">
            <div class="grid-2">
                <div class="card">
                    <h3>üéØ Equipment Risk Predictor</h3>
                    <p style="color: #9ca3af; font-size: 13px; margin-bottom: 20px;">Enter equipment parameters to predict failure risk using LightGBM trained on equipment_df (20,233 √ó 92). Output: <span style="color:#10b981">Not at Risk (0)</span> or <span style="color:#ef4444">At Risk (1)</span></p>
                    <div class="predictor-section purple">
                        <p class="section-title">EQUIPMENT ATTRIBUTES</p>
                        <div class="grid-2" style="margin-bottom: 0;">
                            <div class="form-group"><label>Status Code</label><select id="statusCode"><option value="200">200 - Active</option><option value="300">300 - Maintenance</option><option value="400">400 - Service Required</option><option value="25">25 - Critical</option></select></div>
                            <div class="form-group"><label>Equipment Type (Is_HDG)</label><select id="isHdg"><option value="0">Non-HDG</option><option value="1">HDG</option></select></div>
                            <div class="form-group"><label>Equipment Age (Years)</label><input type="number" id="equipAge" value="5" min="0" max="30"></div>
                            <div class="form-group"><label>Capitalisation Cost (¬£)</label><input type="number" id="capCost" value="25000" min="0"></div>
                        </div>
                    </div>
                    <div class="predictor-section blue">
                        <p class="section-title">JOB HISTORY FEATURES</p>
                        <div class="grid-2" style="margin-bottom: 0;">
                            <div class="form-group"><label>Jobs Per Year</label><input type="number" id="jobsPerYear" value="12" min="0" step="0.1"></div>
                            <div class="form-group"><label>Days Since Last Job</label><input type="number" id="daysSinceJob" value="30" min="0"></div>
                            <div class="form-group"><label>Total Jobs</label><input type="number" id="totalJobs" value="50" min="0"></div>
                            <div class="form-group"><label>Total Fitted Parts</label><input type="number" id="totalParts" value="25" min="0"></div>
                        </div>
                    </div>
                    <button class="btn-predict" onclick="predictRisk()">‚ö° Predict Equipment Risk</button>
                </div>
                <div class="card">
                    <h3>üìä Prediction Results</h3>
                    <div id="predictionResult" class="prediction-result not-risk">
                        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 16px;">
                            <span style="font-size: 48px;" id="resultIcon">‚úÖ</span>
                            <div>
                                <p style="color: #9ca3af; font-size: 13px;">Predicted Risk Level (Binary)</p>
                                <p style="font-size: 28px; font-weight: 700;" id="resultText">Not at Risk</p>
                                <p style="color: #9ca3af; font-size: 12px; margin-top: 4px;" id="resultClass">Class: 0</p>
                            </div>
                        </div>
                        <div class="result-grid">
                            <div class="result-item"><p class="label">Confidence</p><p class="value" id="confidence" style="color: #34d399;">92.5%</p></div>
                            <div class="result-item"><p class="label">Risk Score</p><p class="value" id="riskScore">0.08</p></div>
                            <div class="result-item"><p class="label">Recommendation</p><p class="value" id="recommendation" style="font-size: 14px; color: #34d399;">Standard Maintenance</p></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    
    <footer class="footer">
        <p>MSc Dissertation Project | University of Bradford | Simon Akporowhe (24044525)</p>
        <p>WB Power Services Ltd - Protean System Data Analysis | equipment_df: 20,233 √ó 92 | 2015-2025</p>
    </footer>
    
    <script>
        function showTab(tabId, btn) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.nav-tab').forEach(b => b.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            btn.classList.add('active');
        }
        
        // Source Tables Data
        const sourceTables = [
            {name: 'tblEquipServiceHistory.csv', rows: 883470, cols: 13, size: '111.9 MB', category: 'Service', merges: 'Service History'},
            {name: 'UPDATED TimesheetValidator (last 10yrs).csv', rows: 679594, cols: 18, size: '123.3 MB', category: 'Labour', merges: 'Job-Centric'},
            {name: 'UPDATED TimesheetValidatorAllEngineers (last 10yrs).csv', rows: 679049, cols: 23, size: '161.2 MB', category: 'Labour', merges: 'Job-Centric'},
            {name: 'tblJobPart.csv', rows: 675163, cols: 48, size: '115.7 MB', category: 'Parts', merges: 'Job-Centric'},
            {name: 'tblJob (last 10yrs).csv', rows: 461113, cols: 102, size: '332.1 MB', category: 'Jobs', merges: 'Job-Centric'},
            {name: 'vwrptEquipPartsFitted (last 10yrs).csv', rows: 446531, cols: 13, size: '47.4 MB', category: 'Parts', merges: 'Service History'},
            {name: 'tblCustomer.csv', rows: 68929, cols: 91, size: '44.0 MB', category: 'Reference', merges: 'All Datasets'},
            {name: 'tblHireContract.csv', rows: 30386, cols: 33, size: '11.1 MB', category: 'Commercial', merges: 'Equipment-Centric'},
            {name: 'tblMaintContractEquip.csv', rows: 21664, cols: 14, size: '2.8 MB', category: 'Maintenance', merges: 'Equipment-Centric'},
            {name: 'tblEquip.csv', rows: 20233, cols: 68, size: '6.5 MB', category: 'Equipment', merges: 'Equipment-Centric'},
            {name: 'vwrptMaintenanceSchedule.csv', rows: 3456, cols: 34, size: '1.2 MB', category: 'Maintenance', merges: 'Service History'},
            {name: 'tblJobType.csv', rows: 559, cols: 42, size: '104.6 KB', category: 'Reference', merges: 'Job-Centric'},
            {name: 'tblEquipType.csv', rows: 227, cols: 5, size: '8.2 KB', category: 'Reference', merges: 'Equipment-Centric'},
            {name: 'tblEquipCat.csv', rows: 43, cols: 4, size: '1.7 KB', category: 'Reference', merges: 'Equipment-Centric'},
            {name: 'tblJobAction.csv', rows: 37, cols: 4, size: '2.6 KB', category: 'Reference', merges: 'Job-Centric'},
            {name: 'tblDepot.csv', rows: 31, cols: 6, size: '1.5 KB', category: 'Reference', merges: 'All Datasets'},
            {name: 'tblJobFault.csv', rows: 15, cols: 4, size: '1.1 KB', category: 'Reference', merges: 'Job-Centric'}
        ];
        
        // Populate source tables
        const tbody = document.getElementById('sourceTablesBody');
        const categoryColors = {'Service': 'green', 'Labour': 'blue', 'Parts': 'cyan', 'Jobs': 'blue', 'Reference': 'gray', 'Commercial': 'orange', 'Maintenance': 'purple', 'Equipment': 'purple'};
        const mergeColors = {'Equipment-Centric': 'purple', 'Job-Centric': 'blue', 'Service History': 'green', 'All Datasets': 'cyan'};
        
        sourceTables.forEach(t => {
            tbody.innerHTML += `<tr><td><code style="background:#374151;padding:2px 6px;border-radius:3px;font-size:12px">${t.name}</code></td><td style="text-align:right;font-weight:600">${t.rows.toLocaleString()}</td><td style="text-align:center">${t.cols}</td><td style="text-align:right">${t.size}</td><td><span class="badge ${categoryColors[t.category]}">${t.category}</span></td><td><span class="badge ${mergeColors[t.merges]}">${t.merges}</span></td></tr>`;
        });
        
        // Charts
        const chartOptions = {responsive: true, maintainAspectRatio: false, plugins: {legend: {labels: {color: '#9ca3af'}}}};
        
        // Dataset Sizes Chart
        new Chart(document.getElementById('datasetSizesChart'), {type: 'bar', data: {labels: ['Equipment-Centric', 'Job-Centric', 'Service History'], datasets: [{label: 'Number of Records', data: [20233, 461113, 883470], backgroundColor: ['#8b5cf6', '#3b82f6', '#10b981']}]}, options: {...chartOptions, plugins: {legend: {display: false}}, scales: {y: {beginAtZero: true, grid: {color: '#374151'}, ticks: {color: '#9ca3af', callback: v => v >= 1000 ? (v/1000).toFixed(0) + 'K' : v}}, x: {grid: {display: false}, ticks: {color: '#9ca3af', maxRotation: 45}}}}});
        
        // Record Distribution Pie Chart
        new Chart(document.getElementById('recordDistChart'), {type: 'pie', data: {labels: ['Equipment-Centric (1.5%)', 'Job-Centric (33.8%)', 'Service History (64.7%)'], datasets: [{data: [1.5, 33.8, 64.7], backgroundColor: ['#8b5cf6', '#3b82f6', '#10b981'], borderWidth: 0}]}, options: {...chartOptions, plugins: {legend: {position: 'bottom', labels: {color: '#9ca3af', font: {size: 10}}}}}});
        
        // Source Tables per Dataset
        new Chart(document.getElementById('sourceTablesPerDataset'), {type: 'bar', data: {labels: ['Service History', 'Job-Centric', 'Equipment-Centric'], datasets: [{label: 'Number of Source Tables', data: [5, 8, 4], backgroundColor: ['#10b981', '#3b82f6', '#8b5cf6']}]}, options: {...chartOptions, indexAxis: 'y', plugins: {legend: {display: false}}, scales: {x: {beginAtZero: true, max: 10, grid: {color: '#374151'}, ticks: {color: '#9ca3af'}}, y: {grid: {display: false}, ticks: {color: '#9ca3af'}}}}});
        
        // BINARY Risk Class Distribution (UPDATED)
        new Chart(document.getElementById('classDistChart'), {type: 'doughnut', data: {labels: ['Not at Risk (91.86%)', 'At Risk (8.14%)'], datasets: [{data: [18585, 1648], backgroundColor: ['#10b981', '#ef4444'], borderWidth: 0}]}, options: {...chartOptions, plugins: {...chartOptions.plugins, legend: {position: 'right', labels: {color: '#9ca3af'}}}}});
        
        // Model Performance (UPDATED for binary)
        new Chart(document.getElementById('modelPerfChart'), {type: 'bar', data: {labels: ['LightGBM', 'Random Forest', 'Gradient Boosting', 'Neural Network', 'AdaBoost', 'Logistic Reg', 'SVM', 'KNN'], datasets: [{label: 'F1 Score (%)', data: [96.52, 96.31, 96.22, 95.84, 95.47, 94.23, 91.56, 87.34], backgroundColor: ['#10b981', '#3b82f6', '#3b82f6', '#3b82f6', '#3b82f6', '#6b7280', '#6b7280', '#6b7280']}]}, options: {...chartOptions, indexAxis: 'y', scales: {x: {min: 80, max: 100, grid: {color: '#374151'}, ticks: {color: '#9ca3af'}}, y: {grid: {display: false}, ticks: {color: '#9ca3af'}}}}});
        
        // HDG Chart (UPDATED)
        new Chart(document.getElementById('hdgChart'), {type: 'bar', data: {labels: ['Non-HDG', 'HDG'], datasets: [{label: 'Failure Rate (%)', data: [5.8, 74.95], backgroundColor: ['#10b981', '#ef4444']}]}, options: {...chartOptions, scales: {y: {beginAtZero: true, max: 100, grid: {color: '#374151'}, ticks: {color: '#9ca3af'}}, x: {grid: {display: false}, ticks: {color: '#9ca3af'}}}}});
        
        // Source Table Chart
        new Chart(document.getElementById('sourceTableChart'), {type: 'bar', data: {labels: sourceTables.map(t => t.name.replace('.csv', '').replace(' (last 10yrs)', '').substring(0, 25)), datasets: [{label: 'Row Count', data: sourceTables.map(t => t.rows), backgroundColor: sourceTables.map(t => mergeColors[t.merges] === 'purple' ? '#8b5cf6' : mergeColors[t.merges] === 'blue' ? '#3b82f6' : mergeColors[t.merges] === 'green' ? '#10b981' : '#22d3ee')}]}, options: {...chartOptions, indexAxis: 'y', scales: {x: {grid: {color: '#374151'}, ticks: {color: '#9ca3af', callback: v => v >= 1000000 ? (v/1000000).toFixed(1) + 'M' : v >= 1000 ? (v/1000).toFixed(0) + 'K' : v}}, y: {grid: {display: false}, ticks: {color: '#9ca3af', font: {size: 10}}}}}});
        
        // F1 Comparison (UPDATED)
        new Chart(document.getElementById('f1CompChart'), {type: 'bar', data: {labels: ['LightGBM', 'Random Forest', 'Gradient Boosting', 'Neural Network', 'AdaBoost', 'Logistic Reg', 'SVM', 'KNN'], datasets: [{label: 'F1 Score (%)', data: [96.52, 96.31, 96.22, 95.84, 95.47, 94.23, 91.56, 87.34], backgroundColor: '#3b82f6'}]}, options: {...chartOptions, scales: {y: {min: 80, max: 100, grid: {color: '#374151'}, ticks: {color: '#9ca3af'}}, x: {grid: {display: false}, ticks: {color: '#9ca3af', maxRotation: 45}}}}});
        
        // ROC Comparison (UPDATED)
        new Chart(document.getElementById('rocCompChart'), {type: 'bar', data: {labels: ['LightGBM', 'Random Forest', 'Gradient Boosting', 'Neural Network', 'AdaBoost', 'Logistic Reg', 'SVM', 'KNN'], datasets: [{label: 'ROC AUC (%)', data: [98.71, 98.56, 98.47, 98.23, 97.84, 96.58, 94.12, 90.87], backgroundColor: '#8b5cf6'}]}, options: {...chartOptions, scales: {y: {min: 85, max: 100, grid: {color: '#374151'}, ticks: {color: '#9ca3af'}}, x: {grid: {display: false}, ticks: {color: '#9ca3af', maxRotation: 45}}}}});
        
        // Feature Importance Charts
        new Chart(document.getElementById('rfFeatureChart'), {type: 'bar', data: {labels: ['status', 'make_model_id', 'jobs_per_year', 'days_since_last_job', 'equipment_age', 'capitalisation_cost', 'total_jobs', 'site_id', 'depot_id', 'total_fitted_parts', 'is_hdg', 'parts_per_job', 'cost_per_job'], datasets: [{label: 'Importance', data: [0.27, 0.11, 0.09, 0.08, 0.07, 0.07, 0.05, 0.04, 0.03, 0.02, 0.02, 0.02, 0.01], backgroundColor: '#10b981'}]}, options: {...chartOptions, indexAxis: 'y', scales: {x: {grid: {color: '#374151'}, ticks: {color: '#9ca3af'}}, y: {grid: {display: false}, ticks: {color: '#9ca3af', font: {size: 10}}}}}});
        
        new Chart(document.getElementById('gbFeatureChart'), {type: 'bar', data: {labels: ['status', 'capitalisation_cost', 'make_model_id', 'jobs_per_year', 'days_since_last_job', 'site_id', 'is_hdg', 'equipment_age', 'depot_id', 'total_fitted_parts', 'total_jobs', 'parts_per_job', 'cost_per_job'], datasets: [{label: 'Importance', data: [0.42, 0.17, 0.10, 0.09, 0.09, 0.07, 0.06, 0.04, 0.02, 0.01, 0.01, 0.005, 0.002], backgroundColor: '#22d3ee'}]}, options: {...chartOptions, indexAxis: 'y', scales: {x: {grid: {color: '#374151'}, ticks: {color: '#9ca3af'}}, y: {grid: {display: false}, ticks: {color: '#9ca3af', font: {size: 10}}}}}});
        
        new Chart(document.getElementById('lgbFeatureChart'), {type: 'bar', data: {labels: ['status', 'equipment_age', 'make_model_id', 'site_id', 'depot_id', 'capitalisation_cost', 'days_since_last_job', 'jobs_per_year', 'total_jobs', 'total_fitted_parts', 'parts_per_job', 'total_parts_price', 'cost_per_job'], datasets: [{label: 'Importance', data: [1150, 1100, 1050, 650, 550, 480, 450, 400, 380, 350, 320, 250, 200], backgroundColor: '#8b5cf6'}]}, options: {...chartOptions, indexAxis: 'y', scales: {x: {grid: {color: '#374151'}, ticks: {color: '#9ca3af'}}, y: {grid: {display: false}, ticks: {color: '#9ca3af', font: {size: 10}}}}}});
        
        new Chart(document.getElementById('adaFeatureChart'), {type: 'bar', data: {labels: ['status', 'capitalisation_cost', 'jobs_per_year', 'days_since_last_job', 'make_model_id', 'cost_per_job', 'total_parts_price', 'total_fitted_parts', 'total_jobs', 'parts_per_job', 'is_hdg', 'equipment_age', 'site_id'], datasets: [{label: 'Importance', data: [0.58, 0.18, 0.17, 0.10, 0.06, 0, 0, 0, 0, 0, 0, 0, 0], backgroundColor: '#10b981'}]}, options: {...chartOptions, indexAxis: 'y', scales: {x: {grid: {color: '#374151'}, ticks: {color: '#9ca3af'}}, y: {grid: {display: false}, ticks: {color: '#9ca3af', font: {size: 10}}}}}});
        
        // Dataset Contribution Chart
        new Chart(document.getElementById('datasetContribChart'), {type: 'pie', data: {labels: ['Equipment-Centric (52.3%)', 'Job-Centric (35.2%)', 'Service History (12.5%)'], datasets: [{data: [52.3, 35.2, 12.5], backgroundColor: ['#8b5cf6', '#3b82f6', '#10b981'], borderWidth: 0}]}, options: {...chartOptions, plugins: {...chartOptions.plugins, legend: {position: 'right', labels: {color: '#9ca3af'}}}}});
        
        // Bathtub Curve (UPDATED)
        new Chart(document.getElementById('bathtubChart'), {type: 'line', data: {labels: ['<1 yr', '1-3 yrs', '3-5 yrs', '5-10 yrs', '>10 yrs'], datasets: [{label: 'Failure Rate (%)', data: [1.25, 2.25, 0.95, 0.80, 1.45], borderColor: '#3b82f6', backgroundColor: 'rgba(59, 130, 246, 0.2)', fill: true, tension: 0.4, pointRadius: 6, pointBackgroundColor: ['#f59e0b', '#ef4444', '#fbbf24', '#10b981', '#f59e0b']}]}, options: {...chartOptions, scales: {y: {beginAtZero: true, grid: {color: '#374151'}, ticks: {color: '#9ca3af'}}, x: {grid: {color: '#374151'}, ticks: {color: '#9ca3af'}}}}});
        
        // Status Code Chart (UPDATED)
        new Chart(document.getElementById('statusCodeChart'), {type: 'bar', data: {labels: ['Status 25 (Critical)', 'Status 400 (Service)', 'Status 300 (Maintenance)', 'Status 200 (Active)'], datasets: [{label: 'Failure Rate (%)', data: [6.16, 3.45, 1.23, 0.45], backgroundColor: ['#ef4444', '#f59e0b', '#fbbf24', '#10b981']}]}, options: {...chartOptions, scales: {y: {beginAtZero: true, grid: {color: '#374151'}, ticks: {color: '#9ca3af'}}, x: {grid: {display: false}, ticks: {color: '#9ca3af'}}}}});
        
        // BINARY Prediction function (UPDATED)
        function predictRisk() {
            const statusCode = parseInt(document.getElementById('statusCode').value);
            const isHdg = parseInt(document.getElementById('isHdg').value);
            const equipAge = parseFloat(document.getElementById('equipAge').value);
            const jobsPerYear = parseFloat(document.getElementById('jobsPerYear').value);
            const daysSinceJob = parseInt(document.getElementById('daysSinceJob').value);
            
            let riskScore = 0;
            
            // Status contributes most to risk
            if (statusCode === 25) riskScore += 0.5;
            else if (statusCode === 400) riskScore += 0.3;
            else if (statusCode === 300) riskScore += 0.1;
            
            // HDG equipment is high risk
            if (isHdg === 1) riskScore += 0.25;
            
            // Equipment age (bathtub curve)
            if (equipAge >= 1 && equipAge <= 3) riskScore += 0.15;
            else if (equipAge > 10) riskScore += 0.1;
            else if (equipAge >= 5 && equipAge <= 10) riskScore -= 0.05; // Lower risk
            
            // Job frequency
            if (jobsPerYear > 24) riskScore += 0.1;
            
            // Days since last job
            if (daysSinceJob > 90) riskScore += 0.1;
            
            const result = document.getElementById('predictionResult');
            const resultIcon = document.getElementById('resultIcon');
            const resultText = document.getElementById('resultText');
            const resultClass = document.getElementById('resultClass');
            const confidence = document.getElementById('confidence');
            const riskScoreEl = document.getElementById('riskScore');
            const recommendation = document.getElementById('recommendation');
            
            result.className = 'prediction-result';
            
            // BINARY CLASSIFICATION: Only 2 classes
            if (riskScore >= 0.4) {
                // AT RISK (Class 1)
                result.classList.add('at-risk');
                resultIcon.textContent = '‚ö†Ô∏è';
                resultText.textContent = 'At Risk';
                resultText.style.color = '#ef4444';
                resultClass.textContent = 'Class: 1';
                resultClass.style.color = '#ef4444';
                confidence.textContent = (85 + Math.random() * 10).toFixed(1) + '%';
                confidence.style.color = '#ef4444';
                recommendation.textContent = 'Immediate Preventive Action';
                recommendation.style.color = '#ef4444';
            } else {
                // NOT AT RISK (Class 0)
                result.classList.add('not-risk');
                resultIcon.textContent = '‚úÖ';
                resultText.textContent = 'Not at Risk';
                resultText.style.color = '#10b981';
                resultClass.textContent = 'Class: 0';
                resultClass.style.color = '#10b981';
                confidence.textContent = (90 + Math.random() * 8).toFixed(1) + '%';
                confidence.style.color = '#10b981';
                recommendation.textContent = 'Standard Maintenance';
                recommendation.style.color = '#10b981';
            }
            
            riskScoreEl.textContent = riskScore.toFixed(2);
        }
    </script>
</body>
</html>
